/usr/local/lib/python3.7/dist-packages/torchvision/transforms/transforms.py:258: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  "Argument interpolation should be of type InterpolationMode instead of int. "
/usr/local/lib/python3.7/dist-packages/torch/utils/data/dataloader.py:477: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to /root/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth
  0%|          | 0.00/97.8M [00:00<?, ?B/s]  4%|▍         | 4.06M/97.8M [00:00<00:02, 42.6MB/s] 10%|▉         | 9.33M/97.8M [00:00<00:02, 45.7MB/s] 16%|█▌        | 15.3M/97.8M [00:00<00:01, 49.7MB/s] 21%|██▏       | 20.9M/97.8M [00:00<00:01, 51.6MB/s] 26%|██▌       | 24.9M/97.8M [00:00<00:01, 47.1MB/s] 31%|███       | 30.2M/97.8M [00:00<00:01, 49.1MB/s] 36%|███▌      | 35.2M/97.8M [00:00<00:01, 49.0MB/s] 41%|████      | 39.8M/97.8M [00:00<00:01, 48.5MB/s] 45%|████▌     | 44.2M/97.8M [00:00<00:01, 45.9MB/s] 50%|████▉     | 48.5M/97.8M [00:01<00:01, 40.3MB/s] 54%|█████▎    | 52.5M/97.8M [00:01<00:01, 40.7MB/s] 60%|██████    | 59.1M/97.8M [00:01<00:00, 46.3MB/s] 68%|██████▊   | 66.2M/97.8M [00:01<00:00, 52.3MB/s] 73%|███████▎  | 71.6M/97.8M [00:01<00:00, 52.2MB/s] 79%|███████▉  | 77.6M/97.8M [00:01<00:00, 55.0MB/s] 85%|████████▌ | 83.1M/97.8M [00:01<00:00, 54.3MB/s] 91%|█████████ | 88.5M/97.8M [00:01<00:00, 54.5MB/s] 96%|█████████▌| 93.8M/97.8M [00:01<00:00, 53.5MB/s]100%|██████████| 97.8M/97.8M [00:01<00:00, 51.8MB/s]Called with args:
Namespace(cfg_file='./experiments/config/Office-31/CAN/office31_train_amazon2dslr_cfg.yaml', exp_name='office31_a2d', method='CAN', resume=None, set_cfgs=None, weights=None)
Using config:
{'ADAM': {'BETA1': 0.9, 'BETA2': 0.999},
 'CDD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'INTRA_ONLY': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'CLUSTERING': {'BUDGET': 1000,
                'EPS': 0.005,
                'FEAT_KEY': 'feat',
                'FILTERING_THRESHOLD': 0.05,
                'HISTORY_LEN': 2,
                'SOURCE_BATCH_SIZE': 100,
                'TARGET_BATCH_SIZE': 100,
                'TARGET_DATASET_TYPE': 'SingleDatasetWithoutLabel'},
 'DATASET': {'DATAROOT': './experiments/dataset/Office-31',
             'NUM_CLASSES': 31,
             'SOURCE_NAME': 'amazon',
             'TARGET_NAME': 'dslr'},
 'DATA_TRANSFORM': {'FINESIZE': 224,
                    'FLIP': True,
                    'LOADSIZE': 256,
                    'NORMALIZE_MEAN': [0.485, 0.456, 0.406],
                    'NORMALIZE_STD': [0.229, 0.224, 0.225],
                    'RESIZE_OR_CROP': 'resize_and_crop',
                    'WITH_FIVE_CROP': False},
 'EVAL_METRIC': 'accuracy',
 'EXP': {'LR_DECAY_RATE': 0.1, 'LR_DECAY_STEP': 30},
 'EXP_NAME': 'office31_a2d',
 'INV': {'ALPHA': 0.001, 'BETA': 0.75},
 'MMD': {'ALIGNMENT_FEAT_KEYS': ['feat', 'probs'],
         'JOINT': False,
         'KERNEL_MUL': [2, 2],
         'KERNEL_NUM': [5, 5],
         'LOSS_WEIGHT': 0.3},
 'MODEL': {'FC_HIDDEN_DIMS': [],
           'FEATURE_EXTRACTOR': 'resnet50',
           'PRETRAINED': True},
 'NUM_WORKERS': 8,
 'RESUME': '',
 'SAVE_DIR': './experiments/ckpt',
 'TEST': {'BATCH_SIZE': 30, 'DATASET_TYPE': 'SingleDataset', 'DOMAIN': ''},
 'TRAIN': {'BASE_LR': 0.001,
           'DROPOUT_RATIO': [0.0],
           'LOGGING': True,
           'LR_MULT': 10,
           'LR_SCHEDULE': 'inv',
           'MAX_LOOP': 50,
           'MIN_SN_PER_CLASS': 3,
           'MOMENTUM': 0.9,
           'NUM_LOGGING_PER_LOOP': 6.0,
           'NUM_SELECTED_CLASSES': 10,
           'OPTIMIZER': 'SGD',
           'SAVE_CKPT_INTERVAL': 1.0,
           'SOURCE_BATCH_SIZE': 30,
           'SOURCE_CLASS_BATCH_SIZE': 3,
           'STOP_GRAD': 'layer1',
           'STOP_THRESHOLDS': [0.001, 0.001, 0.001],
           'TARGET_BATCH_SIZE': 30,
           'TARGET_CLASS_BATCH_SIZE': 3,
           'TEST_INTERVAL': 1.0,
           'UPDATE_EPOCH_PERCENTAGE': 1.0,
           'WEIGHT_DECAY': 0.0005},
 'WEIGHTS': ''}
Output will be saved to ./experiments/ckpt/office31_a2d.
Building clustering_amazon dataloader...
Building clustering_dslr dataloader...
Building amazon dataloader...
Building categorical dataloader...
Clustering based on amazon...

